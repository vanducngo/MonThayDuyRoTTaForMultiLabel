2025-08-03 22:31:41,755 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=['OUTPUT_DIR', 'RoTTA_ML/CXR'])
2025-08-03 22:31:41,755 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-03 22:31:41,756 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  SEVERITY: 1.0
  TEST_CORRUPTIONS: ['gaussian_noise', 'shot_noise', 'contrast', 'brightness', 'impulse_noise', 'elastic_transform', 'motion_blur', 'zoom_blur', 'glass_blur', 'defocus_blur', 'pixelate', 'jpeg_compression', 'frost', 'snow', 'fog']
  TEST_DOMAINS: ['nih14']
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: mobilenet_v3_small
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 1e-05
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: RoTTA_ML/CXR
SEED: -1
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-03 22:33:36,351 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=['OUTPUT_DIR', 'RoTTA_ML/CXR'])
2025-08-03 22:33:36,351 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-03 22:33:36,351 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  SEVERITY: 1.0
  TEST_CORRUPTIONS: ['gaussian_noise', 'shot_noise', 'contrast', 'brightness', 'impulse_noise', 'elastic_transform']
  TEST_DOMAINS: ['nih14']
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: mobilenet_v3_small
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 1e-05
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: RoTTA_ML/CXR
SEED: -1
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-03 22:34:22,646 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=['OUTPUT_DIR', 'RoTTA_ML/CXR'])
2025-08-03 22:34:22,646 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-03 22:34:22,646 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  SEVERITY: 1.0
  TEST_CORRUPTIONS: ['gaussian_noise', 'contrast', 'brightness', 'impulse_noise', 'elastic_transform']
  TEST_DOMAINS: ['nih14']
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: mobilenet_v3_small
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 1e-05
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: RoTTA_ML/CXR
SEED: -1
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-03 22:42:13,722 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=['OUTPUT_DIR', 'RoTTA_ML/CXR'])
2025-08-03 22:42:13,722 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-03 22:42:13,722 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  SEVERITY: 1.0
  TEST_CORRUPTIONS: ['gaussian_noise', 'contrast', 'brightness', 'impulse_noise', 'elastic_transform']
  TEST_DOMAINS: ['nih14']
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: mobilenet_v3_small
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 1e-05
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: RoTTA_ML/CXR
SEED: -1
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-03 22:51:08,287 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=['OUTPUT_DIR', 'RoTTA_ML/CXR'])
2025-08-03 22:51:08,287 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-03 22:51:08,287 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  SEVERITY: 0.01
  TEST_CORRUPTIONS: ['gaussian_noise', 'contrast', 'brightness', 'impulse_noise', 'elastic_transform']
  TEST_DOMAINS: ['nih14']
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: mobilenet_v3_small
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 1e-05
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: RoTTA_ML/CXR
SEED: -1
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-03 22:57:10,405 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=['OUTPUT_DIR', 'RoTTA_ML/CXR'])
2025-08-03 22:57:10,405 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-03 22:57:10,405 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  SEVERITY: 0.01
  TEST_CORRUPTIONS: ['gaussian_noise', 'contrast', 'brightness', 'impulse_noise', 'elastic_transform']
  TEST_DOMAINS: ['nih14']
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: mobilenet_v3_small
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  BETA: 0.9
  DAMPENING: 0.0
  LR: 1e-05
  METHOD: Adam
  MOMENTUM: 0.9
  NESTEROV: True
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: RoTTA_ML/CXR
SEED: -1
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
